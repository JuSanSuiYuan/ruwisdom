<!-- ä»ªè¡¨ç›˜é¡µé¢ -->
<view class="dashboard-container">
  <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
  <view class="top-nav">
    <view class="user-info">
      <image class="avatar" src="{{userInfo.avatar || '/images/default-avatar.png'}}"></image>
      <view class="user-details">
        <text class="user-name">{{userInfo.name || 'æ¬¢è¿ä½¿ç”¨'}}</text>
        <text class="user-role">{{userRoleText}}</text>
      </view>
    </view>
    <view class="top-actions">
      <view class="notification-icon" bindtap="navigateToNotifications">
        <image src="/images/notification.png"></image>
        <view class="notification-badge" wx:if="notificationCount > 0">{{notificationCount}}</view>
      </view>
      <view class="settings-icon" bindtap="navigateToSettings">
        <image src="/images/settings.png"></image>
      </view>
    </view>
  </view>

  <!-- å¿«æ·åŠŸèƒ½åŒº -->
  <view class="quick-functions">
    <function-item wx:for="{{quickFunctions}}" wx:key="id" id="{{item.id}}" name="{{item.name}}" bind:click="onFunctionClick"></function-item>
  </view>

  <!-- æ•°æ®ç»Ÿè®¡å¡ç‰‡ -->
  <view class="stats-section">
    <view class="section-title">
      <text>æ•°æ®æ¦‚è§ˆ</text>
      <text class="more" bindtap="onViewMoreStats">æ›´å¤š</text>
    </view>
    <view class="stats-cards">
      <stat-card number="{{statsData.studentsCount}}" label="å­¦ç”Ÿæ€»æ•°" iconText="ğŸ“š" iconBgColor="#e6f7ff"></stat-card>
      <stat-card number="{{statsData.teachersCount}}" label="æ•™å¸ˆæ€»æ•°" iconText="ğŸ‘¨â€ğŸ«" iconBgColor="#f6ffed"></stat-card>
      <stat-card number="{{statsData.parentsCount}}" label="å®¶é•¿æ€»æ•°" iconText="ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦" iconBgColor="#fff7e6"></stat-card>
      <stat-card number="{{statsData.pendingTasks}}" label="å¾…åŠä»»åŠ¡" iconText="ğŸ“‹" iconBgColor="#fff2e8"></stat-card>
    </view>
  </view>

  <!-- æœ€è¿‘æ´»åŠ¨ -->
  <view class="activities-section">
    <view class="section-title">
      <text>æœ€è¿‘æ´»åŠ¨</text>
    </view>
    <view class="activities-list">
      <view wx:if="{{recentActivities.length > 0}}">
        <activity-item wx:for="{{recentActivities}}" wx:key="id" id="{{item.id}}" title="{{item.title}}" time="{{item.time}}" type="{{item.type}}" bind:click="onActivityClick"></activity-item>
      </view>
      <view wx:else class="no-activities">æš‚æ— æ´»åŠ¨è®°å½•</view>
    </view>
  </view>

  <!-- æ•™å¸ˆ/å®¶é•¿ä¸“å±åŒºåŸŸ -->
  <view class="special-section" wx:if="userInfo.role === 'teacher'">
    <view class="section-title">
      <text>ä»Šæ—¥å¾…åŠ</text>
    </view>
    <view class="todo-list">
      <view class="todo-item" wx:for="{{todolist}}" wx:key="id">
        <view class="todo-checkbox"></view>
        <text class="todo-content">{{item.content}}</text>
        <text class="todo-time">{{item.time}}</text>
      </view>
    </view>
  </view>

  <view class="special-section" wx:if="userInfo.role === 'parent'">
    <view class="section-title">
      <text>å­å¥³åŠ¨æ€</text>
    </view>
    <view class="children-activities">
      <view class="child-activity" wx:for="{{childrenActivities}}" wx:key="id">
        <view class="child-name">{{item.childName}}</view>
        <view class="activity-detail">{{item.activity}}</view>
        <text class="activity-time">{{item.time}}</text>
      </view>
    </view>
  </view>
</view>